{% extends "base.html" %}
{% load i18n %}
{% load static %}
{% load crispy_forms_tags %}


{% block content %}
<div class="container mt-5">
    <div class="row">
        <div class="col-lg-12 mb-4">
            <!-- Video Information with Enhanced Styling -->
            <div class="video-info bg-dark-blue text-light p-4 rounded-3 shadow">
                <h3 class="mb-3">{{ video.title }}</h3>
            </div>

            {% if not video.chunks.exists %}
            <!-- Chunking Action Button with Custom Styling -->
            <div class="mt-4">
                <form action="{% url 'chunk_video' video.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-custom-blue bi-stack text-light mb-3">&nbsp;Chunk Transcript</button>
                </form>
            </div>
            {%else%}
            <div class="mt-4">
                <form action="{% url 'chunk_video' video.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-custom-blue bi-stack text-light mb-3">&nbsp;Re-Chunk Transcript</button>
                </form>
            </div>

            {% endif %}
        </div>
    </div>
    <div class="container mt-4 dark-theme">
        <div class="row">
            <div class="col-lg-3">
                <!-- Enhanced Chunks Container on the Left with Dark Theme -->
                <div class="chunks-container shadow p-4 rounded-3 dark-container">
                    <h4 class="text-center mb-4 text-light">Video Chunks</h4>
                    <div class="list-group dark-list-group">
                        {% for chunk in chunks %}
                        <a href="#" class="list-group-item list-group-item-action d-flex justify-content-between align-items-center p-2 dark-list-item video-card rounded-2" onclick="copyToClipboard('{{ chunk.text|escapejs }}'); return false;">
                            <span class="text-light">Chunk {{ forloop.counter }}</span>
                            <small class="text-secondary">Copy</small>
                        </a>
                        {% endfor %}
                    </div>
                </div>
            </div>
            
            <!-- Dynamic Content or Placeholder -->
            <div class="col-8">
                <div class="mb-3">
                    <a href="{% url 'page_processing' video.id %}" class="btn btn-dark btn-lg w-100 bi-cpu fw-bold btn-custom-process rounded-2 video-card">
                        {% trans 'Process Clip Templates' %}
                    </a>
                </div>
                <div>
                    <a href="{% url 'manage_clips' video.id %}" class="btn btn-custom-beige bi-collection btn-lg w-100 btn-custom-manage rounded-2 video-card">
                        &nbsp;Manage Clips
                    </a> 
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Redesigned message container for copy confirmation -->
<div id="copyConfirmation" class="alert alert-success" role="alert" style="display: none; position: fixed; top: 30px; left: 22%; transform: translateX(-50%); z-index: 1050;">
    {% trans "Text Copied!" %}
</div>

{% endblock %}
